<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Start Your Report</title>

<!-- Theme (matches your main page) -->

<style>
:root{
--bg:#0f1220; /* page background */
--panel:#1b2034; /* card background */
--text:#e9eefb; /* body text */
--muted:#9bb1c7; /* secondary text */
--accent:#ffd233; /* yellow brand */
--ink:#111; /* black on yellow */
--ring: rgba(255,210,51,.45);
--border:#242b44;
--glass: rgba(255,255,255,.06);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
margin:0;
color:var(--text);
background:
radial-gradient(1200px 600px at 20% -10%, #222a48 0%, transparent 60%),
radial-gradient(1000px 600px at 90% -20%, #1b2034 0%, transparent 60%),
var(--bg);
font:16px/1.55 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

.wrap{
min-height:100%;
display:grid;
place-items:start center;
padding:32px 18px 64px;
}
.card{
width:min(900px, 94vw);
background: linear-gradient(180deg, #1b2034, #151a2b);
border:1px solid var(--border);
border-radius:16px;
padding:28px;
box-shadow: 0 12px 40px rgba(0,0,0,.35), inset 0 1px 0 var(--glass);
}

h1{
margin:0 0 8px;
font-size:clamp(26px, 3.2vw, 40px);
letter-spacing:.2px;
}
.meta{
color:var(--muted);
font-size:.95rem;
margin-bottom:22px;
}

.grid {
display: grid;
gap: 16px;
grid-template-columns: 1fr; /* one column only */
}
@media (max-width: 880px){
.grid{ grid-template-columns:1fr 1fr; }
}
@media (max-width: 560px){
.grid{ grid-template-columns:1fr; }
}

.field{
background: rgba(255,255,255,.03);
border:1px solid #2e3654;
border-radius:12px;
padding:14px 14px 10px;
transition:border-color .15s, box-shadow .15s;
}
.label{
display:block;
color:var(--muted);
font-weight:700;
font-size:.92rem;
margin:0 0 8px;
}
input[type="number"], input[type="text"], textarea{
width:100%;
color:var(--text);
background:#0f1426;
border:1px solid #2e3654;
border-radius:10px;
padding:12px 14px;
outline:none;
transition:border-color .15s, box-shadow .15s;
}
input:focus, textarea:focus{
border-color:var(--accent);
box-shadow:0 0 0 4px var(--ring);
}

textarea{
min-height:160px;
resize:vertical;
}

.note{
color:var(--muted);
margin-top:6px;
font-size:.9rem;
}

.actions{
display:flex;
gap:12px;
align-items:center;
margin-top:18px;
flex-wrap:wrap;
}
.btn{
display:inline-block;
border-radius:12px;
padding:12px 18px;
font-weight:800;
border:1px solid transparent;
text-decoration:none;
cursor:pointer;
user-select:none;
transition:transform .045s ease, filter .12s, box-shadow .12s, background .12s;
}
.btn:active{ transform:translateY(1px) }

.btn-primary{
background:var(--accent);
color:var(--ink);
box-shadow: 0 10px 24px rgba(255,210,51,.25);
}
.btn-primary:hover{ filter:saturate(1.05) brightness(1.02) }
.btn-ghost{
background:transparent;
color:var(--text);
border-color:#2e3654;
}

.msg{ margin-top:14px; font-weight:700 }
.msg.ok{ color:#22cc88 }
.msg.err{ color:#ff5577 }

/* little divider card for the narrative */
.section{
margin-top:18px;
padding-top:6px;
border-top:1px solid #232842;
}
  .note {
margin-top: 6px;
color: var(--muted, #c9c9c9);
font-size: .92rem;
}

button[disabled] {
opacity: .6;
cursor: not-allowed;
filter: saturate(.5);
}
</style>
</head>
<body>
<div class="wrap">
<div class="card">
  <!-- Hero Section -->
<div class="report-hero">
<h1>üî• Start Your Report. Sharpen Your Edge.</h1>
<p class="hero-subtext">
This is not busywork ‚Äî it‚Äôs your <strong>checkpoint</strong>. Every reflection here measures
where you stood strong, where you slipped, and where you‚Äôll rise next.
</p>

<ul class="hero-list">
<li>‚úÖ <strong>Be Honest</strong> ‚Äî Patterns matter more than perfect answers.</li>
<li>‚úÖ <strong>Stack Wins</strong> ‚Äî One small improvement, repeated, changes everything.</li>
<li>‚úÖ <strong>Aim Forward</strong> ‚Äî End each section with one action you‚Äôll take in the next two weeks.</li>
</ul>

<p class="hero-footer">
<strong>Why It Matters:</strong><br>
Discipline, responsibility, morality, skill, vision, and legacy don‚Äôt improve by accident.
They improve when measured. This report is how you measure, reset, and raise your standards.
</p>

<p class="hero-motivation">
Take 10 minutes. Be real. Leave stronger than you arrived.
</p>
</div>

<!-- Add this CSS -->
<style>
.report-hero {
text-align: center;
background: linear-gradient(145deg, #1c1c1c, #2a2a2a);
color: #f5f5f5;
padding: 2rem;
border-radius: 12px;
margin-bottom: 2rem;
box-shadow: 0 4px 15px rgba(0,0,0,0.4);
}

.report-hero h1 {
font-size: 2rem;
margin-bottom: 1rem;
color: #ff4d4d; /* bold motivating color */
}

.report-hero .hero-subtext {
font-size: 1.1rem;
margin-bottom: 1rem;
}

.report-hero .hero-list {
list-style: none;
padding: 0;
margin: 1rem 0;
text-align: left;
max-width: 600px;
margin-left: auto;
margin-right: auto;
}

.report-hero .hero-list li {
margin: 0.5rem 0;
font-size: 1rem;
}

.report-hero .hero-footer {
font-size: 1rem;
margin-top: 1rem;
line-height: 1.5;
}

.report-hero .hero-motivation {
margin-top: 1rem;
font-size: 1.2rem;
font-weight: bold;
color: #ffd166;
}
</style>
<h1>Start Your Report</h1>
<div class="meta" id="periodMeta">Signed in as ‚Ä¢ Period: </div>

<!-- Scores grid -->
<div class="grid">
<div class="field">
<label class="label" for="pd_note">Physical Discipline</label>
<textarea id="pd_note" class="tarea" placeholder="What training, sleep, or nutrition wins did you have? Where did discipline slip? What‚Äôs the one improvement you‚Äôll make next?"></textarea>
</div>

<div class="field">
<label class="label" for="ro_note">Responsibility to Others</label>
<textarea id="ro_note" class="tarea" placeholder="How did you show up for family, friends, team, or community? What do you regret not doing? What will you do differently?"></textarea>
</div>

<div class="field">
<label class="label" for="bm_note">Belief & Morality</label>
<textarea id="bm_note" class="tarea" placeholder="What principles guided your choices? Any moments you compromised or stood firm? One concrete way to align actions and values next."></textarea>
</div>

<div class="field">
<label class="label" for="sm_note">Skill & Mastery</label>
<textarea id="sm_note" class="tarea" placeholder="What skills did you practice or ship? Where did you get stuck? What‚Äôs the next deliberate practice or milestone?"></textarea>
</div>

<div class="field">
<label class="label" for="sr_note">Self-Reliance</label>
<textarea id="sr_note" class="tarea" placeholder="Where did you solve problems independently? Where did dependency creep in? What‚Äôs one system or preparation you‚Äôll add?"></textarea>
</div>

<div class="field">
<label class="label" for="ic_note">Integrity & Consistency</label>
<textarea id="ic_note" class="tarea" placeholder="Did your actions match your word? Where did you drift? What small daily habit will lock integrity in?"></textarea>
</div>
</div>
<!-- Narrative -->
<div class="section field" style="margin-top:22px;">
<label class="label" for="notes">Narrative / Reflection</label>
<textarea id="notes" placeholder="What went well? What needs work? What‚Äôs one explicit commitment for the next two weeks?"></textarea>
<small class="note" id="cooldownNote"></small>
</div>

<!-- Actions -->
<!-- Success + Countdown placeholders -->
<div id="msg" class="msg"></div>
<div id="cooldownNote" class="note"></div>

<!-- Actions -->
<div class="actions">
<button id="saveBtn" class="btn btn-primary">Save Report</button>
<a class="btn btn-ghost" href="/">Back to Home</a>
</div>

<!-- (Optional) Hook up period text + cooldown display if you already compute these in JS -->
<script>
// Example: set the period line dynamically if you have start/end dates available
// document.getElementById('periodMeta').textContent =
// `Signed in as ${email} ‚Ä¢ Period: ${periodStart} ‚Üí ${periodEnd}`;

// Example: show a cooldown note if you‚Äôre enforcing 14-day spacing server-side
// const msLeft = /* compute ms until next allowed report */ 0;
// const cd = document.getElementById('cooldownNote');
// if (msLeft > 0) {
// const days = Math.floor(msLeft / 86400000);
// const hours = Math.floor((msLeft % 86400000) / 3600000);
// cd.textContent = `Next report available in ${days}d ${hours}h.`;
// }

// Wire your existing save logic to #saveBtn and the field IDs above.
// On success: msg('Saved ‚úî', true) ; on error: msg('Error ‚Ä¶', false)
function msg(text, ok){
const m = document.getElementById('msg');
m.textContent = text;
m.className = 'msg ' + (ok ? 'ok' : 'err');
}
</script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
// üîß Replace these with your Supabase project values
const SUPABASE_URL = 'https://qsvelfkcaaqxgaewwwog.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFzdmVsZmtjYWFxeGdhZXd3d29nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5ODUwNDYsImV4cCI6MjA3MjU2MTA0Nn0.kBZLf09JYQQNK-2xsJs5mj2m43q8bHgVs2jEZvObkMQ';
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

const $ = (s)=>document.querySelector(s);

function msg(text, ok=true){
const el = $('#msg'); if(!el) return;
el.textContent = text;
el.className = 'msg ' + (ok ? 'ok':'err');
}

function gatherForm(){
return {
physical: $('#pd_note')?.value?.trim() || '',
others: $('#ro_note')?.value?.trim() || '',
morality: $('#bm_note')?.value?.trim() || '',
mastery: $('#sm_note')?.value?.trim() || '',
selfreliance: $('#sr_note')?.value?.trim() || '',
integrity: $('#ic_note')?.value?.trim() || '',
notes: $('#notes')?.value?.trim() || ''
};
}

// ‚è≥ countdown helpers
const DAY = 86400000;
const COOLDOWN_MS = 13 * DAY; // 13 days
function startCountdown(){
const cdEl = $('#cooldownNote'), btn = $('#saveBtn');
const target = parseInt(localStorage.getItem('nextReportAt'),10);
if(!cdEl || !target) return;

function update(){
const left = target - Date.now();
if (left <= 0){
cdEl.textContent = "üéâ You can submit a new report now.";
btn?.removeAttribute('disabled');
clearInterval(t);
return;
}
const d = Math.floor(left / DAY);
const h = Math.floor((left % DAY) / 3600000);
const m = Math.floor((left % 3600000) / 60000);
cdEl.textContent = `‚è≥ Next report in ${d}d ${h}h ${m}m`;
btn?.setAttribute('disabled','true'); // block during cooldown
}

update();
const t = setInterval(update, 60000); // update every minute
}

async function saveReport(){
const btn = $('#saveBtn');
btn?.setAttribute('disabled','true');
msg('Saving‚Ä¶');

// must be logged in
const { data:{ user }, error:authErr } = await supabase.auth.getUser();
if(authErr || !user){ msg('Please sign in first.', false); btn?.removeAttribute('disabled'); return; }

// send to DB (expects a JSONB column "form_data" in public.reports)
const payload = {
user_id: user.id,
pillar_scores: gatherForm(), // goes into JSONB
narrative: document.getElementById('notes')?.value.trim() || '', // goes into text
period_start: new Date().toISOString().slice(0, 10),
period_end: new Date(Date.now() + 13 * 86400000).toISOString().slice(0, 10)
};

const { data, error } = await supabase
.from('reports')
.insert(payload)
.select('id')
.single();

if (error) {
msg('Error saving: ' + error.message, false);
btn?.removeAttribute('disabled');
return;
} else {
console.log("Report inserted with id:", data.id);
}

// success + start cooldown
msg('‚úÖ Report saved! You‚Äôll receive a human response within 48 hours.', true);
const next = Date.now() + COOLDOWN_MS;
localStorage.setItem('nextReportAt', String(next));
startCountdown();
}

document.addEventListener('DOMContentLoaded', () => {
$('#saveBtn')?.addEventListener('click', saveReport);
if(localStorage.getItem('nextReportAt')) startCountdown();
});
</script>
  <script>
(function () {
// ---- 1) Prompt banks (10 pairs = 20 prompts per pillar) ----
const PROMPTS = {
pd_note: [
{ past: "What training, sleep, or nutrition win defined the last 2 weeks?", future: "What one physical habit will you improve in the next 2 weeks?" },
{ past: "Where did your discipline slip in the last 2 weeks?", future: "What safeguard will you add to hold discipline in the next 2 weeks?" },
{ past: "What recovery practices helped most?", future: "What recovery change will make the biggest difference in the next 2 weeks?" },
{ past: "When did you push past comfort in the last 2 weeks?", future: "Where will you seek discomfort next to grow stronger?" },
{ past: "What consistent small win did you rack up physically?", future: "What single habit will you double down on for the next 2 weeks?" },
{ past: "What derailed your nutrition or training?", future: "What pre-plan will stop that derailment next time?" },
{ past: "What was your toughest physical test?", future: "What deliberate test will you set for yourself in the next 2 weeks?" },
{ past: "How well did you sleep and recover overall?", future: "What‚Äôs one practical step to lock in better rest?" },
{ past: "What energy trends did you notice over the last 2 weeks?", future: "What shift will you make to sustain higher energy?" },
{ past: "What moment made you feel strongest?", future: "What moment do you want to create in the next 2 weeks?" }
],
ro_note: [
{ past: "Who benefited most from your presence in the last 2 weeks?", future: "Who will you invest extra energy in over the next 2 weeks?" },
{ past: "When did you fail to show up for someone?", future: "What concrete step will you take to repair or show up better?" },
{ past: "What team or family moment stands out?", future: "What moment will you intentionally create in the next 2 weeks?" },
{ past: "Who needed encouragement and got it?", future: "Who will you encourage directly in the next 2 weeks?" },
{ past: "What promise did you keep?", future: "What promise will you make and keep in the next 2 weeks?" },
{ past: "When did you put self over others?", future: "What one sacrifice will you make for others in the next 2 weeks?" },
{ past: "What service act defined your last 2 weeks?", future: "What service act will define the next 2 weeks?" },
{ past: "Where did you avoid responsibility?", future: "Where will you lean in next time?" },
{ past: "Who did you mentor or guide?", future: "Who will you intentionally guide in the next 2 weeks?" },
{ past: "How did you support your community?", future: "What specific community action will you take soon?" }
],
bm_note: [
{ past: "What principle guided your hardest choice?", future: "What principle will you commit to living more visibly?" },
{ past: "Where did you compromise values?", future: "Where will you refuse compromise in the next 2 weeks?" },
{ past: "What virtue was strongest in your last 2 weeks?", future: "What virtue will you strengthen going forward?" },
{ past: "Where were words and actions misaligned?", future: "What action will you align to your words?" },
{ past: "When did you stand firm under pressure?", future: "Where will you prepare to stand firm next?" },
{ past: "What temptation did you resist?", future: "What temptation will you guard against next?" },
{ past: "What moral example did you set?", future: "What moral example do you want others to see?" },
{ past: "What situation tested your values most?", future: "What upcoming situation will test them again?" },
{ past: "When did you inspire belief in others?", future: "How will you inspire belief next?" },
{ past: "What lesson about morality did you learn?", future: "What lesson will you live out in the next 2 weeks?" }
],
sm_note: [
{ past: "What skill progressed most in the last 2 weeks?", future: "What single drill will accelerate mastery in the next 2 weeks?" },
{ past: "Where did you get stuck?", future: "What exact drill or experiment will break the block?" },
{ past: "What milestone did you achieve?", future: "What milestone is next on the path?" },
{ past: "What new knowledge was most useful?", future: "What knowledge will you seek out in the next 2 weeks?" },
{ past: "What feedback helped you improve?", future: "Who will you request feedback from next?" },
{ past: "Where did you waste effort?", future: "What system will you use to cut wasted effort?" },
{ past: "What output are you proud of?", future: "What output will you produce in the next 2 weeks?" },
{ past: "Where did you shrink from challenge?", future: "What challenge will you face head-on?" },
{ past: "What tool or method helped?", future: "What tool or method will you adopt?" },
{ past: "What tiny improvement compounded?", future: "What small improvement will you compound next?" }
],
sr_note: [
{ past: "What problem did you solve independently?", future: "What problem will you take full ownership of next?" },
{ past: "Where did dependency creep in?", future: "What system will you add to reduce dependency?" },
{ past: "When did you take initiative?", future: "Where will you take initiative next?" },
{ past: "What resourcefulness did you show?", future: "What resource will you create or secure next?" },
{ past: "When did you adapt to solve a challenge?", future: "What adaptation will you practice in the next 2 weeks?" },
{ past: "Where did you lean too much on others?", future: "Where will you strengthen independence?" },
{ past: "What survival or practical skill did you use?", future: "What survival or practical skill will you develop?" },
{ past: "When did you take responsibility for your own prep?", future: "What prep will you add next?" },
{ past: "What self-sufficient habit grew?", future: "What habit will you establish next?" },
{ past: "What was your strongest independent action?", future: "What independent action will you take in the next 2 weeks?" }
],
ic_note: [
{ past: "Did your actions match your words?", future: "What one small action will reinforce your word next?" },
{ past: "Where did you drift from consistency?", future: "What habit will lock integrity in place?" },
{ past: "What routine held firm?", future: "What routine will you establish or strengthen?" },
{ past: "Where did you break a commitment?", future: "What new system will help you keep it next time?" },
{ past: "When did you persist despite low motivation?", future: "Where will you persist again?" },
{ past: "What truth was hardest to admit?", future: "What truth will you commit to live out?" },
{ past: "What habit gave the biggest payoff?", future: "What habit will you reinforce daily?" },
{ past: "When did you act with integrity unseen?", future: "What unseen integrity act will you repeat?" },
{ past: "What consistency gave you strength?", future: "What consistency will you double down on?" },
{ past: "Where were you two-faced?", future: "Where will you unify inner and outer self?" }
],
narrative_note: [
{ past: "What story defined your last 2 weeks?", future: "What story do you want to write in the next 2 weeks?" },
{ past: "What went well?", future: "What one explicit commitment will you make for the next 2 weeks?" },
{ past: "What needs work?", future: "What concrete step will you take to address it?" },
{ past: "What lesson did you learn?", future: "What lesson will you apply forward?" },
{ past: "What surprised you?", future: "What surprise will you prepare for next?" },
{ past: "What felt heavy?", future: "What will you lighten in the next 2 weeks?" },
{ past: "What connection mattered most?", future: "What connection will you invest in next?" },
{ past: "What setback taught you most?", future: "What comeback will you plan next?" },
{ past: "What theme tied your last 2 weeks?", future: "What theme will define your next 2 weeks?" },
{ past: "What memory stands out most?", future: "What memory do you want to create soon?" }
]
};

// ---- 2) Determine today's index (0‚Äì9) ----
function dayIndex() {
const d = new Date();
const start = new Date(d.getFullYear(), 0, 0);
const diff = d - start + (start.getTimezoneOffset() - d.getTimezoneOffset()) * 60000;
const day = Math.floor(diff / 86400000);
return (day % 10); // 0‚Äì9 for 10-day cycle
}
const todayIndex = dayIndex();

// ---- 3) Render prompts into placeholders + helper text ----
Object.entries(PROMPTS).forEach(([id, pairs]) => {
const ta = document.getElementById(id);
if (!ta) return;

const { past, future } = pairs[todayIndex];
ta.setAttribute("placeholder", past + "\n\n" + future);

const label = document.querySelector(`label[for="${id}"]`);
if (label && !label.nextElementSibling?.classList?.contains("today-note")) {
const note = document.createElement("div");
note.className = "today-note";
note.innerHTML = `<strong>Past:</strong> ${past}<br><strong>Future:</strong> ${future}`;
label.insertAdjacentElement("afterend", note);
}
});
})();
</script>

<style>
.today-note{
color: var(--muted, #9c9c9c);
font-size: .9rem;
margin: 6px 0 8px;
}
</style>

</body>
</html>
